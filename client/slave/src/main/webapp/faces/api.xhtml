<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core" template="/faces/template.xhtml">

	<ui:define name="title">API</ui:define>

	<ui:define name="content">
	
		<p>Alle datasett har faste adresser bygget opp på denne måten:</p>

		<p>http://hotell.difi.no/api/[format]/[eier]/[gruppe]/[datasett]</p>
		
		
		<h3>Eksempel på nedlasting av datasett</h3>
		
		<p>Dersom jeg for eksempel ønsker å laste ned Difis liste over fylker, i json-format, kan jeg gjøre det fra denne adressen:</p>
		
		<p><a href="/api/json/difi/geo/fylke">http://hotell.difi.no/api/json/difi/geo/fylke</a></p>
		
		<p>Dersom jeg ønsker å laste ned den samme listen i csv-format, kan jeg gjøre det fra denne adressen:</p>
		
		<p><a href="/api/csv/difi/geo/fylke">http://hotell.difi.no/api/csv/difi/geo/fylke</a></p>
		
		<p>Merk at datasett på mer enn 100 poster har pagination, se neste avsnitt.</p>
		
		
		<h3>Pagination</h3>
		
		<p>Presentasjon av datasett foregår med pagination, og det vil vises maks 100 poster om gangen ved utlisting (gjelder ikke søk og oppslag). For å vise neste side benytter man parameteret <em>page</em> hvor første side er <em>page=1</em> (1-indeksert). Eksempel:</p>

		<p><a href="/api/json/fmsf/partistotte/2011?page=8">http://hotell.difi.no/api/json/fmsf/partistotte/2011?page=8</a></p>
		
		<p>Ved uthenting av data hvor pagination benyttes finnes det metadata om dette i HTTP-header. Følgende parametere kan hentes:</p>
		
		<ul>
			<li>X-Datahotel-Page</li>
			<li>X-Datahotel-Total-Pages</li>
			<li>X-Datahotel-Total-Posts</li>
		</ul>
		
		
		<h3>ETag</h3>
		
		<p>Alle oppslag som henter data (ikke oversikt over organisasjoner, grupper og datasett) har støtte for ETag.</p>
		
		
		<h3>Eksempel på nedlasting av feltdefinisjoner</h3>
		
		<p>Alle felt i datahotellet er definert minst med navn, beskrivelse, type (for eksempel om det er et navn, en kategorisering, et fylkesnummer, et kommunenummer eller en måleenhet), om de er søkbare, grupperbare og om de kan gjøres oppslag i. Feltdefinisjonene for datasettet du er interessert i kan lastes ned i json:</p>
		
		<p><a href="/api/json/difi/geo/fylke/fields">http://hotell.difi.no/api/json/difi/geo/fylke/fields</a></p>
		
		<p>Eller i xml:</p>
		
		<p><a href="/api/json/difi/geo/fylke/fields">http://hotell.difi.no/api/xml/difi/geo/fylke/fields</a></p>
		
		
		<h3>Eksempel på oppslag i API'et</h3>
		
		<p>Det er to måter å hente ut spesifikke data på. Den første måten er å søke. Du kan for eksempel søke på fylker som har ordet «Agder» i seg, og få resultatet ut i json, på denne måten:</p>
		
		<p><a href="/api/json/difi/geo/fylke?query=agder">http://hotell.difi.no/api/json/difi/geo/fylke?query=agder</a></p>
		
		<p>Når man gjør et slikt søk søker man i alle felt som er satt som søkbare (at et felt er søkbart betyr at det i feltdefinisjonen må stå at searchable = True). </p>
		
		<p>Den andre måten å hente ut spesifikke data på er å gjøre oppslag. Man kan kun gjøre oppslag i felt der groupable = True. Det er ingen grupperbare felt i listen over fylker. Det er det derimot i datasettet til Difis miljøkalkulator. Kallet settes opp på denne måten:</p>
		
		<p>url-til-datasett?feltnavn=søkestreng</p>
		
		<p>Hvis jeg ønsker å hente ned alle poster som har kategorien «transport» kan jeg derfor gjøre det ved å hente data fra denne URLen:</p>
		
		<p><a href="/api/json/difi/miljo/kalkulator?kategori=transport">http://hotell.difi.no/api/json/difi/miljo/kalkulator?kategori=transport</a></p>
		
		
		<h3>Teknisk beskrivelse av APIet i XML-format</h3>
		
		<p>En standardisert definisjon av APIet i XML-format er tilgjengelig på denne adressen:</p>
		
		<p><a href="/api/application.wadl">http://hotell.difi.no/api/application.wadl</a></p>
	</ui:define>

</ui:composition>

